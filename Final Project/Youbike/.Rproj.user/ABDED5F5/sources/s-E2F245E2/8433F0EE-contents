map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner-lite")

res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res5 + aes(x = lng, y = lat, z = X8) +
  stat_summary_2d(fun = median, alpha = 0.6) +
  scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), limits = c(0, 1), breaks = seq(0, 1, by = 0.25)) +
  labs(x = "Longitude", y = "Latitude") +
  coord_map() +
  ggtitle('Remaining Percentage of Youbike in Taipei') +
  geom_jitter(shape = 1)
res.stat.map