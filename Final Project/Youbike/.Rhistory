stat_summary(geom = 'point', fun.y = median,
size = 5,
col = '#CCEEFF', fill = 'black', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 5,
fill = '#CCEEFF', col = 'black', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 3,
fill = '#CCEEFF', col = 'black', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 4,
fill = '#CCEEFF', col = 'black', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 4,
fill = '#CCEEFF', col = '#003377', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 3.5,
fill = '#CCEEFF', col = '#003377', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 3,
fill = '#CCEEFF', col = '#003377', shape = 21) +
ggtitle('Five-number Summary Plot')
ggplot(res3, aes(x = sarea, y = X7)) +
geom_point(shape = 1, alpha = 0.5, position = position_jitter(width = 0.1)) +
stat_summary(fun.data = med_IQR, geom = 'linerange', col = "#0088A8", size = 3, alpha = 0.8) +
stat_summary(fun.data = gg_range, geom = 'linerange', width = 0.2, col = "#0088A8", alpha = 0.2, size = 3) +
stat_summary(geom = 'point', fun.y = median,
size = 3,
fill = '#CCEEFF', col = 'red', shape = 21) +
ggtitle('Five-number Summary Plot')
runApp()
runApp()
runApp()
runApp()
runApp()
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner-lite")
ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat) +
geom_jitter()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(ggmap)
library(ggplot2)
library(gganimate)
library(viridis)
library(RColorBrewer)
library(raster)
library(tidyr)
library(tweenr)
library(magick)
library(stringr)
library(lubridate)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
sbi <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_sbi.csv')
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner-lite")
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res7.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
res.stat.map.ani <- ggmap(map, darken = c(0.5, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Sunday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
library(ggmap)
library(ggplot2)
library(gganimate)
library(viridis)
library(RColorBrewer)
library(raster)
library(tidyr)
library(tweenr)
library(magick)
library(stringr)
library(lubridate)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner-lite")
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res1.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
res.stat.map.ani <- ggmap(map, darken = c(0.5, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res.stat.map.ani <- ggmap(map, darken = c(0.5, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
shiny::runApp()
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner")
ggmap(map)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
library(rgdal)
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'taipei_town')
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
library(ggfortify)
library(ggmap)
library(ggplot2)
library(gganimate)
library(viridis)
library(RColorBrewer)
library(raster)
library(tidyr)
library(tweenr)
library(magick)
library(stringr)
library(lubridate)
library(rgdal)
library(ggfortify)
taipei <- fortify(taipei)
View(taipei)
# Map
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner")
# Map + Data
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
View(res)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
#geom_polygon(data = taipei,
#aes(x = long, y = lat, group = group),
#fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
ggmap(map) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
taipei <- fortify(taipei)
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
View(taipei)
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
taipei <- fortify(taipei)
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 6), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 10), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 12), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11, maptype = 'toner-lite'), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11.5, maptype = 'toner-lite'), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
map <- get_map(location = c(min(taipei$long), min(taipei$lat), max(taipei$long), max(res$lat)), maptype = "toner")
map <- get_map(location = c(min(taipei$long), min(taipei$lat), max(taipei$long), max(taipei$lat)), maptype = "toner")
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.8, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#000000")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#000000", width = 0.1)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.6, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.8, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.8, "white")) +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res1.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
runApp()
runApp()
runApp()
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res3.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Wednesday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res4.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Thursday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res5.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Friday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res6.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Saturday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res7.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Sunday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
runApp()
