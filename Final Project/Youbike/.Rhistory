labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
shiny::runApp()
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner")
ggmap(map)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
library(rgdal)
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'taipei_town')
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
library(ggfortify)
library(ggmap)
library(ggplot2)
library(gganimate)
library(viridis)
library(RColorBrewer)
library(raster)
library(tidyr)
library(tweenr)
library(magick)
library(stringr)
library(lubridate)
library(rgdal)
library(ggfortify)
taipei <- fortify(taipei)
View(taipei)
# Map
map <- get_map(location = c(min(res$lng), min(res$lat), max(res$lng), max(res$lat)), maptype = "toner")
# Map + Data
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res.csv')
View(res)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X307) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
#geom_polygon(data = taipei,
#aes(x = long, y = lat, group = group),
#fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
ggmap(map) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
taipei <- fortify(taipei)
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
View(taipei)
taipei <- readOGR(dsn = 'D:/GitHub/NTU-CS-X/Final Project/Youbike/data/taipei_town', layer = 'Taipei_town')
taipei <- fortify(taipei)
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 6), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 10), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 12), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11, maptype = 'toner-lite'), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(get_map(location = 'taipei', zoom = 11.5, maptype = 'toner-lite'), darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
map <- get_map(location = c(min(taipei$long), min(taipei$lat), max(taipei$long), max(res$lat)), maptype = "toner")
map <- get_map(location = c(min(taipei$long), min(taipei$lat), max(taipei$long), max(taipei$lat)), maptype = "toner")
ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.8, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#000000")
ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#000000", width = 0.1)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) %+% res + aes(x = lng, y = lat, z = X308) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.5, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "red") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.6, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.7, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.8, "white")) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
res.stat.map <- ggmap(map, darken = c(0.8, "white")) +
stat_summary_2d(data = res, aes(x = lng, y = lat, z = X308), fun = median, alpha = 0.6) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black") +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(x = "Longitude", y = "Latitude") +
coord_map() +
ggtitle('Remaining Amount of Youbike in Taipei')
print(res.stat.map)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res1.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "black",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Monday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
runApp()
runApp()
runApp()
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res3.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Wednesday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res4.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Thursday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res5.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Friday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res6.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Saturday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
# res
res3 <- read.csv('D:/GitHub/NTU-CS-X/Final Project/Youbike/data/Youbike_res7.csv')
res3_g <- gather(res3, time, per, X7:X24)
res3_g$time <- str_replace(res3_g$time, 'X', '')
# Animation
res.stat.map.ani <- ggmap(map, darken = c(0.6, "white")) %+% res3_g + aes(x = lng, y = lat, z = per) +
stat_summary_2d(fun = median, alpha = 0.8) +
geom_polygon(data = taipei,
aes(x = long, y = lat, group = group),
fill = NA, col = "#666666",
inherit.aes = FALSE) +
scale_fill_gradientn(name = 'Median', colours = brewer.pal(11, "RdYlGn"), space = 'Lab') +
labs(title = 'Sunday, {closest_state}', x = "Longitude", y = "Latitude") +
coord_map() +
transition_states(time, transition_length = 1, state_length = 1)
print(res.stat.map.ani)
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
shade %>%
filter(x1 > as.Date(input$Time[1], "%Y-%m-%d") & x2 <= as.Date(input$Time[2], "%Y-%m-%d")) + 2
runApp('D:/Desktop/Line')
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade %>%
+        filter(x1 > as.Date(input$Time[1], "%Y-%m-%d") & x2 <= as.Date(input$Time[2], "%Y-%m-%d")) + 2
shade %>%
filter(x1 > as.Date('2018-08-01', "%Y-%m-%d") & x2 <= as.Date('2018-08-02', "%Y-%m-%d")) + 2
shade %>%
filter(x1 > as.Date('2018-08-01', "%Y-%m-%d") & x2 <= as.Date('2018-08-02', "%Y-%m-%d")) + 2
shade %>%
filter(x1 > as.Date('2018-08-01', "%Y-%m-%d") & x2 <= as.Date('2018-08-02', "%Y-%m-%d") + 2)
shade %>%
filter(x1 >= as.Date('2018-08-01', "%Y-%m-%d") & x2 <= as.Date('2018-08-02', "%Y-%m-%d") + 2)
shade %>%
filter(as.Date(x1, "%Y-%m-%d-%h") >= as.Date('2018-08-01', "%Y-%m-%d") & as.Date(x1, "%Y-%m-%d-%h") <= as.Date('2018-08-02', "%Y-%m-%d") + 2)
shade %>%
filter(as.Date(x1, "%Y-%m-%d-%h") >= as.Date('2018-08-01', "%Y-%m-%d") & as.Date(x1, "%Y-%m-%d-%h") <= as.Date('2018-08-02', "%Y-%m-%d"))
shade %>%
filter(as.Date(x1, "%Y-%m-%d-%h") >= as.Date('2018-08-01', "%Y-%m-%d") & as.Date(x1, "%Y-%m-%d-%h") <= as.Date('2018-08-04', "%Y-%m-%d"))
View(shade)
shade %>%
filter(x1 > '2018-08-01')
library(lubridate)
shade %>%
filter(x1 > ymd('2018-08-01'))
ymd('2018-08-01') > ymd('2018-08-02')
ymd_h('2018-08-01-07') > ymd('2018-08-01')
shade %>%
filter(ymd_h(x1) > ymd('2018-08-01'))
shade %>%
filter(ymd_h(x1) > ymd('2018-08-02'))
shade %>%
filter(ymd_h(x1) > ymd('2018-08-01'))
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
all_regions <- sort(unique(sbi_line$sarea))
min_date <- min(sbi_line$Time)
max_date <- max(sbi_line$Time)
View(sbi_line)
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
sbi_line <- rbind(sbi_line, NA)
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
View(sbi_line)
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
View(sbi_line)
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = TRUE)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
sbi_line$g <- cumsum(apply(sbi_line, 1, anyNA))
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
View(sbi_line)
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
runApp()
shiny::runApp()
shiny::runApp('D:/Desktop/Line')
runApp('D:/Desktop/Line')
sbi <- read.csv('D:/Desktop/Line/Youbike_sbi(1).csv')
sbi_line <- sbi %>% gather( Time, value, X2018.8.1.7:X2018.8.4.9, na.rm = F)
sbi_line <- select(sbi_line,sarea,Time,value)
sbi_line <- sbi_line %>% group_by(sarea,Time) %>% summarise(mean=mean(value))
sbi_line$Time <- str_replace(sbi_line$Time, 'X', '')
sbi_line$Time <- ymd_h(sbi_line$Time)
sbi_line <- separate(sbi_line,Time,c("day","hour"),sep=" ",remove=FALSE)
sbi_line$g <- cumsum(apply(sbi_line, 1, anyNA))
all_regions <- sort(unique(sbi_line$sarea))
min_date <- min(sbi_line$Time)
max_date <- max(sbi_line$Time)
shade <- read.csv('D:/Desktop/Line/shade.csv')
shade$x1<-ymd_h(shade$x1)
shade$x2<-ymd_h(shade$x2)
View(sbi_line)
View(shade)
runApp('D:/Desktop/Line')
